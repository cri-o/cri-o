---

- name: stat the expected cri-o directory
  stat:
    path: "{{ ansible_env.GOPATH }}/src/github.com/kubernetes-incubator/cri-o"
  register: dir_stat

- name: expect cri-o to be cloned already
  fail:
    msg: "Expected cri-o to be cloned at {{ ansible_env.GOPATH }}/src/github.com/kubernetes-incubator/cri-o but it wasn't!"
  when: not dir_stat.stat.exists

- name: build cri-o
  make:
    chdir: "{{ ansible_env.GOPATH }}/src/github.com/kubernetes-incubator/cri-o"
